"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2168],{7235:(e,t,s)=>{s.d(t,{d:()=>n});var i=s(95155);s(12115);var a=s(27599),l=s(25016);function n(e){let{className:t,...s}=e;return(0,i.jsx)(a.bL,{"data-slot":"switch",className:(0,l.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:(0,i.jsx)(a.zi,{"data-slot":"switch-thumb",className:(0,l.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}},15982:(e,t,s)=>{s.d(t,{A:()=>u});var i=s(95155),a=s(12115),l=s(67909),n=s(36335),r=s(73552),o=s.n(r),d=s(62690),c=s.n(d),h=s(41949);let p=(0,l.default)(()=>s.e(1592).then(s.bind(s,41592)),{loadableGenerated:{webpack:()=>[41592]},ssr:!1}),u=e=>{let t=(0,h.M)(),[s,l]=(0,a.useState)(null),[r,d]=(0,a.useState)(null);return(0,a.useEffect)(()=>{l({code:t=>{let s=Array.isArray(t.children)?t.children[0]:t.children;return t.inline?(0,i.jsx)("code",{children:s}):(0,i.jsx)(p,{language:t.language||t.className,value:s,disableCopyPaste:e.disableCopyPaste})},a:e=>(0,i.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer nofollow",children:e.children})}),d((null==t?void 0:t.theme)==="dark"?"dark":"light")},[null==t?void 0:t.theme]),(0,i.jsx)(n.$,{className:"prose dark:prose-invert max-w-none md-view md-view oc-theme-".concat(r," ").concat(e.disableCopyPaste?"unselectable":""),remarkPlugins:[c(),o()],components:{pre:e=>{let{children:t}=e;return(0,i.jsx)("pre",{className:"not-prose border-0",style:{background:"transparent"},children:t})},...s||{}},children:e.markdown||""})}},32168:(e,t,s)=>{s.r(t),s.d(t,{default:()=>e$});var i=s(95155),a=s(12115),l=s(1213),n=s(88605),r=s(40967),o=s(54679),d=s(33789),c=s(90235),h=s(54664),p=s(7235),u=s(58896);let m=e=>{let t=(0,l.wA)(),s=(0,l.d4)(e=>e.user.editorFontSize)||14,a=(0,l.d4)(e=>e.user.editorDisableAutoComplete)||!1;return(0,i.jsx)(o.lG,{open:e.open,onOpenChange:e.onClose,children:(0,i.jsxs)(o.Cf,{className:"sm:max-w-md",children:[(0,i.jsx)(o.c7,{children:(0,i.jsx)(o.L3,{children:"Editor Settings"})}),(0,i.jsx)(h.w,{}),(0,i.jsxs)("div",{className:"space-y-6 py-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.J,{htmlFor:"fontSize",children:"Font Size (8-32)"}),(0,i.jsx)(d.p,{id:"fontSize",type:"number",min:8,max:32,value:s,onChange:e=>t((0,u.HM)(e.target.value))})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)(c.J,{htmlFor:"autoComplete",className:"flex-1 pr-4",children:"Disable Code Autocomplete / Suggestions"}),(0,i.jsx)(p.d,{id:"autoComplete",checked:a,onCheckedChange:e=>t((0,u.h$)(e))})]})]})]})})};var x=s(861),g=s(65229),j=s(86651),b=s(93499),v=s(12758),f=s.n(v),y=s(67812),w=s(97003),N=s(44877);let C=e=>{let[t,s]=(0,a.useState)(""),l=[];return["Programming","Web","Database","Tool"].map(s=>{l.push({languageType:s,languageTitle:"Tool"===s?"Tools":"".concat(s," languages"),languagesAvailable:((e,s)=>{let i="";return t&&(i=Object.keys(n).filter(e=>e.toLowerCase().includes(t.toLowerCase())||n[e].name.toLowerCase().includes(t.toLowerCase()))),(i||Object.keys(n)).filter(e=>n[e].active).filter(t=>n[t].languageType===e).filter(e=>!s||!!s.includes(e))})(s.toLowerCase(),e.availableLanguages)})}),(0,i.jsx)(o.lG,{open:e.open,onOpenChange:()=>{e.onClose()},children:(0,i.jsxs)(o.Cf,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto p-0",showCloseButton:!1,children:[(0,i.jsx)(x.s6,{children:(0,i.jsx)(o.L3,{children:"Select Language"})}),(0,i.jsx)("div",{className:"flex justify-end px-4 pt-4",children:(0,i.jsxs)("div",{className:"relative w-full md:w-1/3",children:[(0,i.jsx)(d.p,{placeholder:"Search languages...",value:t,onChange:e=>s(e.target.value),className:"pr-10",autoFocus:!0}),(0,i.jsx)(w.$,{variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full",onClick:()=>s(""),children:t?(0,i.jsx)(g.A,{className:"h-4 w-4"}):(0,i.jsx)(j.A,{className:"h-4 w-4"})})]})}),(0,i.jsxs)("div",{className:"px-5 pb-4",children:[l.map(t=>(0,i.jsx)(a.Fragment,{children:0!==t.languagesAvailable.length&&(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-secondary mb-2 dark:text-foreground",children:t.languageTitle}),(0,i.jsx)(h.w,{}),(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-1 mt-2",children:t.languagesAvailable.map(t=>{let s=n[t];return"home"!==e.source&&s.beta?null:s.properties&&s.properties.url?(0,i.jsxs)("a",{href:s.properties.url,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 rounded cursor-pointer hover:bg-muted flex items-center gap-1",children:[(0,i.jsx)("span",{className:"text-sm ",children:s.name}),(0,i.jsx)(b.A,{className:"h-3 w-3"})]},t):(0,i.jsx)("div",{className:"p-1.5 rounded cursor-pointer hover:bg-muted",onClick:()=>e.handleListItemClick(t),children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"text-sm text-primary dark:text-foreground",children:s.name}),s.beta&&(0,i.jsx)(b.A,{className:"h-3 w-3 ml-1 text-primary"})]})},t)})})]})},t.languageType)),"home"===e.source&&(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-secondary mb-2 dark:text-foreground",children:"Studio"}),(0,i.jsx)(h.w,{}),(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-1 mt-2",children:(t?Object.values(N).filter(e=>!e.deprecated&&e.title.toLowerCase().includes(t.toLowerCase())):Object.values(N).filter(e=>!e.deprecated)).map(e=>(0,i.jsx)("a",{href:"/studio/".concat(e._id),target:"_blank",rel:"noopener noreferrer",className:"p-1.5 rounded cursor-pointer hover:bg-muted",children:(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)("span",{className:"text-sm text-primary dark:text-foreground",children:e.title}),e.freeTier&&(0,i.jsx)(y.E,{variant:"secondary",className:"h-4 text-[10px] font-semibold bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-300 px-1",children:"Free Tier"})]})},e._id))})]}),"home"===e.source&&!1]})]})})};C.propTypes={onClose:f().func,selectedValue:f().string};var k=s(55791),O=s(26667),S=s(35299),A=s(95740),I=s(5917),T=s(75426),F=s(9602),_=s(25016),U=s(32559),M=s(67001),z=s(82180);let E=["A serene mountain landscape at sunset","A futuristic city with flying cars","A magical forest with glowing mushrooms","A cozy coffee shop on a rainy day","A space station orbiting Earth","A dragon flying over medieval castle"],L=function(e){let{open:t,codeId:s,userId:l,handleClose:n,userToken:r}=e,[d,p]=(0,a.useState)(""),[u,m]=(0,a.useState)(null),[x,g]=(0,a.useState)(!1),[j,b]=(0,a.useState)(""),[v,f]=(0,a.useState)(""),[y,N]=(0,a.useState)("vivid"),[C,L]=(0,a.useState)("standard"),$=(0,a.useRef)(null);(0,a.useEffect)(()=>{u&&$.current&&setTimeout(()=>{$.current.scrollIntoView({behavior:"smooth",block:"nearest"})},100)},[u]);let P=async()=>{if(!d.trim())return void b("Please enter a prompt");if(!l||!s)return void b("Please save your code first to generate images");g(!0),b(""),m(null);try{let{statusCode:e,json:t,error:i}=await (0,k.RA)("/api/ai/image/".concat(l,"/").concat(s),r,{module:"editor",usecase:"generateImage",prompt:d.trim(),style:y,quality:C,size:"1024x1024"});200===e?(null==t?void 0:t.message)&&t.message.content&&t.message.content.includes("daily limit")?b("You have reached the daily limit for AI image generation. Please upgrade to a paid plan to continue."):(null==t?void 0:t.status)==="success"&&(null==t?void 0:t.url)?m(t.url):b((null==t?void 0:t.error)||i||"Failed to generate image"):b((null==t?void 0:t.error)||i||"Failed to generate image")}catch(e){b("Failed to generate image. Please try again.")}finally{g(!1)}},R=e=>{if(!u)return;let t="";switch(e){case"url":default:t=u;break;case"img":t='<img src="'.concat(u,'" />');break;case"markdown":t="![".concat(d,"](").concat(u,")")}navigator.clipboard.writeText(t),f(e),setTimeout(()=>f(""),2e3)},V=()=>{n(),setTimeout(()=>{m(null),p(""),b("")},300)},D=l&&s&&d.trim()&&!x;return(0,i.jsx)(o.lG,{open:t,onOpenChange:e=>!e&&V(),children:(0,i.jsxs)(o.Cf,{className:"sm:max-w-2xl max-h-[90vh] flex flex-col gap-0 p-0 overflow-hidden",children:[(0,i.jsxs)(o.c7,{className:"px-6 pt-6 pb-4",children:[(0,i.jsxs)(o.L3,{className:"flex items-center gap-2",children:[(0,i.jsx)(O.A,{className:"h-5 w-5 text-primary"}),"AI Image Generation"]}),(0,i.jsx)(o.rr,{children:"Describe the image you want to create and let AI generate it for you."})]}),(0,i.jsx)(h.w,{}),(0,i.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-5",children:[!l&&(0,i.jsx)(U.Fc,{variant:"warning",children:(0,i.jsx)(U.TN,{children:"Please login to generate AI images"})}),!s&&l&&(0,i.jsx)(U.Fc,{variant:"warning",children:(0,i.jsx)(U.TN,{children:"Please save your code first (Ctrl+S) to generate images"})}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsx)(c.J,{htmlFor:"prompt",children:"Prompt"}),(0,i.jsx)(M.T,{id:"prompt",value:d,onChange:e=>{p(e.target.value),j&&b("")},placeholder:"A magical forest with bioluminescent plants and a crystal clear stream...",disabled:x,rows:3,className:(0,_.cn)("resize-none",j&&"border-destructive focus-visible:ring-destructive")}),j&&(0,i.jsx)("p",{className:"text-sm text-destructive",children:j})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.J,{className:"text-muted-foreground text-xs",children:"Try a sample"}),(0,i.jsx)("div",{className:"flex flex-wrap gap-1.5",children:E.map((e,t)=>(0,i.jsx)("button",{type:"button",disabled:x,onClick:()=>{p(e)},className:(0,_.cn)("text-xs px-2.5 py-1 rounded-full border bg-background transition-colors","hover:bg-accent hover:border-primary/50","disabled:opacity-50 disabled:pointer-events-none",d===e&&"bg-primary/10 border-primary text-primary"),children:e},t))})]}),(0,i.jsxs)("div",{className:"flex items-end gap-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.J,{className:"text-xs",children:"Style"}),(0,i.jsxs)("div",{className:"flex gap-1",children:[(0,i.jsx)(w.$,{variant:"vivid"===y?"default":"outline",size:"sm",onClick:()=>N("vivid"),disabled:x,children:"Vivid"}),(0,i.jsx)(w.$,{variant:"natural"===y?"default":"outline",size:"sm",onClick:()=>N("natural"),disabled:x,children:"Natural"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.J,{className:"text-xs",children:"Quality"}),(0,i.jsxs)("div",{className:"flex gap-1",children:[(0,i.jsx)(w.$,{variant:"standard"===C?"default":"outline",size:"sm",onClick:()=>L("standard"),disabled:x,children:"Standard"}),(0,i.jsx)(w.$,{variant:"hd"===C?"default":"outline",size:"sm",onClick:()=>L("hd"),disabled:x,children:"HD"})]})]}),(0,i.jsxs)(w.$,{onClick:P,disabled:!D,className:"ml-auto",children:[x?(0,i.jsx)(S.A,{className:"h-4 w-4 animate-spin"}):(0,i.jsx)(A.A,{className:"h-4 w-4"}),x?"Generating...":"Generate"]})]}),u&&(0,i.jsxs)("div",{ref:$,className:"space-y-3",children:[(0,i.jsx)(h.w,{}),(0,i.jsx)("div",{className:"rounded-lg overflow-hidden border bg-muted/30",children:(0,i.jsx)("img",{src:u,alt:"Generated",className:"w-full h-auto max-h-[350px] object-contain"})}),(0,i.jsx)("div",{className:"flex justify-end gap-2",children:(0,i.jsxs)(z.Bc,{delayDuration:0,children:[(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsxs)(w.$,{variant:"outline",size:"sm",onClick:()=>R("url"),children:["url"===v?(0,i.jsx)(I.A,{className:"h-3.5 w-3.5 text-green-600"}):(0,i.jsx)(T.A,{className:"h-3.5 w-3.5"}),"url"===v?"Copied!":"URL"]})}),(0,i.jsx)(z.ZI,{children:"Copy image URL"})]}),(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsxs)(w.$,{variant:"outline",size:"sm",onClick:()=>R("img"),children:["img"===v?(0,i.jsx)(I.A,{className:"h-3.5 w-3.5 text-green-600"}):(0,i.jsx)(F.A,{className:"h-3.5 w-3.5"}),"img"===v?"Copied!":"<img>"]})}),(0,i.jsx)(z.ZI,{children:"Copy HTML image tag"})]})]})})]})]}),(0,i.jsx)(h.w,{}),(0,i.jsx)(o.Es,{className:"px-6 py-3",children:(0,i.jsx)(w.$,{variant:"ghost",onClick:V,children:"Close"})})]})})};var $=s(52619),P=s.n($),R=s(65961);let V=e=>{let{codeObj:t}=e;return(0,i.jsx)("div",{className:"pt-0.5 pr-0.5 float-right",children:(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,i.jsxs)("span",{itemProp:"datePublished",dateTime:"".concat(new Date(t.updated).toISOString().split("T")[0]),children:["created ".concat((0,R.A)(new Date(t.created),{max:1,suffix:!0}))," "]}),t.user&&t.user.name&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:" by "}),(0,i.jsx)(P(),{href:"/users/".concat(t.user._id),className:"text-primary hover:underline",children:(0,i.jsx)("span",{itemProp:"author",itemScope:!0,itemType:"http://schema.org/Person",children:(0,i.jsx)("span",{itemProp:"name",children:"".concat(t.user.name)})})})]})]})})};var D=s(92364);let Z=e=>{let{open:t,handleClose:s,codeObj:a,handleUpdate:l,visibility:n,token:r,handleSave:h}=e;return(0,i.jsx)(o.lG,{open:t,onOpenChange:e=>!e&&s(),children:(0,i.jsxs)(o.Cf,{className:"sm:max-w-2xl",children:[(0,i.jsx)(o.c7,{children:(0,i.jsx)(o.L3,{children:"Code Details"})}),(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.J,{htmlFor:"name",children:"Name"}),(0,i.jsx)(d.p,{id:"name",value:a.title,onChange:e=>l("title",e.target.value)})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.J,{htmlFor:"description",children:"Description"}),(0,i.jsx)(M.T,{id:"description",rows:4,value:a.description||"",onChange:e=>l("description",e.target.value)})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.J,{htmlFor:"tags",children:"Tags"}),(0,i.jsx)(d.p,{id:"tags",value:a.tags?a.tags.join(", "):"",onChange:e=>{let t=e.target.value;t?l("tags",t.split(",").map(e=>e.trim().toLowerCase())):l("tags",[])}})]}),!n&&r&&(0,i.jsx)("div",{className:"space-y-2",children:(0,i.jsx)(D.A,{value:a.visibility||"public",onChange:e=>l("visibility",e)})})]}),(0,i.jsxs)(o.Es,{children:[(0,i.jsx)(w.$,{variant:"outline",onClick:s,children:"Close"}),(0,i.jsx)(w.$,{variant:"outline",onClick:h,children:"Save"})]})]})})},J=e=>{var t,s,a,l,n;let{codeObj:r}=e;return(0,i.jsx)("div",{className:"w-full",children:(0,i.jsx)("div",{className:"p-2 overflow-auto max-h-[calc(100vh-110px)] border rounded-md",children:(0,i.jsx)("pre",{children:(null==r||null==(s=r.properties)||null==(t=s.files)?void 0:t.length)>0?null==r||null==(n=r.properties)||null==(l=n.files)||null==(a=l[0])?void 0:a.content:""})})})};var B=s(24033),G=s(85921),H=s(20017),W=s(31959),q=s(21397),Y=s(35541),K=s(38367),Q=s(7220),X=s(41949),ee=s(77625),et=s(52987),es=s(18085),ei=s(11742),ea=s(93409),el=s(83101);let en=ea.bL;ea.l9,ea.bm;let er=ea.ZL,eo=(0,el.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-300 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-[500px] max-w-full border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right"}},defaultVariants:{side:"right"}}),ed=a.forwardRef((e,t)=>{let{side:s="right",className:a,children:l,showCloseButton:n=!0,...r}=e;return(0,i.jsx)(er,{children:(0,i.jsxs)(ea.UC,{ref:t,className:(0,_.cn)(eo({side:s}),a),...r,children:[n&&(0,i.jsxs)(ea.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,i.jsx)(g.A,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Close"})]}),l]})})});ed.displayName="SheetContentNoOverlay";let ec=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(ea.hE,{ref:t,className:(0,_.cn)("text-lg font-semibold text-foreground",s),...a})});ec.displayName=ea.hE.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(ea.VY,{ref:t,className:(0,_.cn)("text-sm text-muted-foreground",s),...a})}).displayName=ea.VY.displayName;var eh=s(15982);function ep(e){let{sendMessage:t,userToken:s,embedMode:l}=e,[n,r]=(0,a.useState)(""),o=(0,a.useRef)(null),d=async()=>{n&&""!==n.trim()&&(t(n),r(""),o.current&&(o.current.style.height="auto"))};return(0,i.jsxs)(i.Fragment,{children:[!s&&!l&&(0,i.jsx)(U.Fc,{variant:"warning",className:"mx-2 mb-2",children:(0,i.jsxs)(U.TN,{className:"flex items-center justify-between",children:[(0,i.jsx)("span",{children:"Please login to interact with the AI"}),(0,i.jsx)(w.$,{variant:"outline",size:"sm",onClick:()=>window.open("/login","_blank"),children:"Login"})]})}),(0,i.jsxs)("div",{className:"flex items-center p-2 gap-2 bg-background",children:[(0,i.jsx)("div",{className:"flex-1 flex items-center border rounded-md p-2 ml-2",children:(0,i.jsx)("textarea",{ref:o,disabled:!s&&!l,value:n,onChange:e=>{r(e.target.value),o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),d())},placeholder:"Leave a message (Shift+Enter for new line)",className:"w-full border-none outline-none resize-none bg-transparent text-foreground min-h-6 max-h-30 overflow-auto leading-normal",rows:1})}),(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsx)(w.$,{variant:"ghost",size:"icon",disabled:!n||""===n.trim()||!s&&!l,onClick:d,children:(0,i.jsx)(es.A,{className:"h-4 w-4"})})}),(0,i.jsx)(z.ZI,{children:"Send"})]})]})]})}let eu=e=>{let t=(0,l.wA)(),s=(0,K.q)(),[n,r]=a.useState([]),[o,d]=(0,a.useState)(!1),[c,p]=(0,a.useState)(!1),{token:m,plan:x}=(0,l.d4)(e=>e.user),g=(0,a.useRef)(null),j=e.embedMode||!1,[b]=(0,a.useState)(()=>Math.floor(10*Math.random()));async function v(t){if((null==t?void 0:t.length)>2e3)return alert("Message is too long. Please keep it under 2000 characters.");r(e=>[...e,{content:t,role:"user"}]),p(!0);let s={content:"",role:"assistant"};r(e=>[...e,s]);let i="";try{var a,l,o,d,c,h,u,x;let p=await fetch("".concat("https://api.onecompiler.com","/api/ai/stream"),{method:"POST",headers:{"Content-Type":"application/json",...m&&{Authorization:"Bearer ".concat(m)}},body:JSON.stringify({module:"editor",usecase:j?"codeHelpEmbedded":"codeHelp",currentMessage:t,conversation:n,modelPreference:b,metadata:{language:null==(l=e.codeObj)||null==(a=l.properties)?void 0:a.language,files:null==(d=e.codeObj)||null==(o=d.properties)?void 0:o.files,stdin:null==(h=e.codeObj)||null==(c=h.properties)?void 0:c.stdin,stdout:null==(x=e.codeObj)||null==(u=x.properties)?void 0:u.stdout}})});if(!p.ok)throw Error("HTTP error! status: ".concat(p.status));let g=p.body.getReader(),v=new TextDecoder,f=!1;for(;!f;){let{value:e,done:t}=await g.read();if(f=t,e){let t=v.decode(e);i+=t,r(e=>{let t=[...e];return t[t.length-1]={...s,content:i},t})}}}catch(e){console.error("Streaming error: ".concat(null==e?void 0:e.message)),r(e=>{let t=[...e];return t[t.length-1]={...s,content:"Sorry, I couldn't get a response. Please try again."},t})}p(!1)}(0,a.useEffect)(()=>{g.current&&g.current.scrollIntoView({behavior:"smooth"})},[n]),(0,a.useEffect)(()=>{if(o){let e=window.scrollY;document.body.style.position="fixed",document.body.style.top="-".concat(e,"px"),document.body.style.width="100%"}else{let e=document.body.style.top;document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,-1*parseInt(e||"0"))}return()=>{document.body.style.position="",document.body.style.top="",document.body.style.width=""}},[o]);let f=()=>{window.open("/pricing","_blank")};return s?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsxs)(w.$,{size:"sm",className:"bg-emerald-500 hover:bg-emerald-600 text-white h-7 px-1 text-sm mr-1",onClick:()=>{d(!0),!m||x||j||t((0,u.D)(m))},children:[(0,i.jsx)(A.A,{className:"mr-0.5 h-3.5 w-3.5"}),"AI"]})}),(0,i.jsx)(z.ZI,{children:"AI Help"})]}),(0,i.jsx)(en,{open:o,onOpenChange:d,modal:!1,children:(0,i.jsxs)(ed,{side:"right",className:"p-0 flex flex-col",showCloseButton:!1,onOpenAutoFocus:e=>e.preventDefault(),children:[(0,i.jsxs)("div",{className:"flex justify-between items-center py-1 pt-3 pb-0 px-3",children:[(0,i.jsx)(ec,{children:"Editor AI"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[!x&&!j&&(0,i.jsxs)(w.$,{variant:"outline",size:"sm",onClick:f,disabled:!m,children:["Upgrade",(0,i.jsx)(ee.A,{className:"ml-1 h-4 w-4"})]}),(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsx)("button",{onClick:()=>{d(!1)},className:"p-1 hover:bg-accent rounded-sm",children:(0,i.jsx)(et.A,{className:"h-5 w-5"})})}),(0,i.jsx)(z.ZI,{children:"Close AI Chat"})]})]})]}),(0,i.jsx)(h.w,{}),(0,i.jsx)("div",{id:"scrollableDiv",className:"flex-1 overflow-auto flex flex-col-reverse",children:(0,i.jsx)("div",{className:"flex-1 p-2",children:(0,i.jsxs)(ei.A,{dataLength:n.length,next:()=>{},inverse:!1,style:{display:"flex",flexDirection:"column"},hasMore:!1,scrollableTarget:"scrollableDiv",loader:null,children:[0===n.length&&(0,i.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,i.jsx)(O.A,{className:"h-12 w-12 mx-auto mb-4 opacity-70"}),(0,i.jsxs)("p",{className:"text-sm",children:["Ask me anything about your code! ",(0,i.jsx)("br",{})," I have the latest version of your code and the output of your code."]})]}),n.length>0&&n.map((e,t)=>{var s;return(0,i.jsx)("div",{className:"mb-4",children:"user"===e.role?(0,i.jsxs)("div",{className:"flex items-start",children:[(0,i.jsx)("span",{className:"text-muted-foreground font-mono text-sm mr-2",children:">"}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)("p",{className:"font-mono text-sm text-foreground whitespace-pre-wrap",children:e.content})})]}):(0,i.jsxs)("div",{children:[""===e.content&&c&&(0,i.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,i.jsx)("span",{className:"text-sm italic",children:"Thinking..."}),(0,i.jsxs)("div",{className:"flex gap-0.5",children:[(0,i.jsx)("span",{className:"w-1 h-1 rounded-full bg-current animate-pulse"}),(0,i.jsx)("span",{className:"w-1 h-1 rounded-full bg-current animate-pulse",style:{animationDelay:"0.2s"}}),(0,i.jsx)("span",{className:"w-1 h-1 rounded-full bg-current animate-pulse",style:{animationDelay:"0.4s"}})]})]}),e.content&&(0,i.jsx)(eh.A,{markdown:null==e?void 0:e.content}),(null==e||null==(s=e.content)?void 0:s.startsWith("You have reached the daily limit"))&&!j&&(0,i.jsx)("div",{className:"flex justify-center mt-4",children:(0,i.jsx)(w.$,{size:"sm",variant:"outline",onClick:f,children:"Upgrade"})})]})},t)}),(0,i.jsx)("div",{ref:g})]})})}),(0,i.jsx)(h.w,{}),(0,i.jsx)(ep,{sendMessage:v,userToken:m,embedMode:j})]})})]}):null};var em=s(61654),ex=s(47507);let eg=/^[a-z0-9_-]+$/,ej=e=>{let{codeObj:t,hideIcon:s,open:n,onOpenChange:r}=e,[h,p]=(0,a.useState)(!1),u=void 0!==n?n:h,m=void 0!==r?r:p,[x,g]=(0,a.useState)(!1),[j,v]=(0,a.useState)(!1),[f,y]=(0,a.useState)(""),[N,C]=(0,a.useState)({slug:"",title:"",description:"",visibility:"public"}),[O,A]=(0,a.useState)({}),[I,T]=(0,a.useState)(null),[F,E]=(0,a.useState)(""),L=(0,l.d4)(e=>e.user.token),$=(0,l.d4)(e=>e.user.plan);(0,a.useEffect)(()=>{P()},[u,t]);let P=async()=>{if(u&&t&&t._id){v(!0),y("");try{let{statusCode:e,json:s,error:i}=await (0,k.ZM)("/api/deployments/getDeploymentBySourceId/".concat(t._id),L);200===e&&s&&s.slug?(C({slug:s.slug||"",title:s.title||"",description:s.description||"",visibility:s.visibility||"public"}),T(s._id)):(C({slug:"",title:"",description:"",visibility:"public"}),T(null))}catch(e){y("Failed to fetch deployment info.")}finally{v(!1)}}else u&&(C({slug:"",title:"",description:"",visibility:"public"}),T(null));y(""),E(""),A({})},R=e=>{let{name:t,value:s}=e.target;"slug"===t&&(s=s.replace(/[^a-z0-9_-]/g,"")),C({...N,[t]:s}),A({...O,[t]:void 0})},V=async()=>{let e=(()=>{let e={};return N.slug?N.slug.length<4?e.slug="App Id must be at least ".concat(4," characters"):N.slug.length>63?e.slug="App Id must be at most ".concat(63," characters"):eg.test(N.slug)||(e.slug="Only lowercase letters, numbers, _ and - allowed"):e.slug="App Id is required",N.title?N.title.length>50&&(e.title="App Title must be at most ".concat(50," characters")):e.title="App Title is required",N.description&&N.description.length>1e3&&(e.description="App Description must be at most ".concat(1e3," characters")),e})();if(Object.keys(e).length)return void A(e);g(!0),y(""),E("");try{var s,i;let{statusCode:e,json:a}=await (0,k.ZM)("/api/deployments/isSlugAvailable/".concat(N.slug),L);if(200!==e||a&&!1===a.available){A(e=>({...e,slug:"Slug is not available. Please choose another."})),g(!1);return}let{statusCode:l,json:n,error:r}=await (0,k.RA)("/api/deployments",L,{...N,sourceId:t._id,_id:I,files:null==t||null==(s=t.properties)?void 0:s.files,source:"editor"});200===l&&"success"===n.status?(E("Deployment saved successfully!"),T(null==n||null==(i=n.doc)?void 0:i._id)):y(n&&n.message||r||"Failed to save deployment")}catch(e){y("Failed to save deployment")}finally{g(!1)}},D=!t||!t._id;return(0,i.jsxs)(i.Fragment,{children:[!s&&(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsx)("button",{type:"button",className:"inline-flex items-center justify-center size-10 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors mr-1",onClick:()=>m(!0),children:(0,i.jsx)(em.A,{className:"h-5 w-5 text-muted-foreground"})})}),(0,i.jsx)(z.ZI,{children:"Deploy this program"})]}),(0,i.jsx)(o.lG,{open:u,onOpenChange:m,children:(0,i.jsxs)(o.Cf,{className:"sm:max-w-md",children:[(0,i.jsx)(o.c7,{children:(0,i.jsx)(o.L3,{children:"Deploy Program"})}),(0,i.jsx)("div",{className:"py-4",children:D?(0,i.jsx)(U.Fc,{variant:"warning",children:(0,i.jsx)(U.TN,{children:"Please change & run the code before deploy."})}):j?(0,i.jsx)("div",{className:"flex justify-center items-center min-h-[100px]",children:(0,i.jsx)(S.A,{className:"h-8 w-8 animate-spin text-primary"})}):(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)(c.J,{htmlFor:"title",children:["App Title ",(0,i.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,i.jsx)(d.p,{id:"title",name:"title",value:N.title,onChange:R,maxLength:50,disabled:x,className:(0,_.cn)(O.title&&"border-destructive")}),(0,i.jsx)("p",{className:(0,_.cn)("text-xs",O.title?"text-destructive":"text-muted-foreground"),children:O.title||"".concat(N.title.length,"/").concat(50," characters")})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.J,{htmlFor:"description",children:"App Description"}),(0,i.jsx)(M.T,{id:"description",name:"description",value:N.description,onChange:R,maxLength:1e3,disabled:x,rows:3,className:(0,_.cn)(O.description&&"border-destructive")}),(0,i.jsx)("p",{className:(0,_.cn)("text-xs",O.description?"text-destructive":"text-muted-foreground"),children:O.description||"".concat(N.description.length,"/").concat(1e3," characters")})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)(c.J,{htmlFor:"slug",children:["App Id ",(0,i.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,i.jsx)(d.p,{id:"slug",name:"slug",value:N.slug,onChange:R,maxLength:63,disabled:x,className:(0,_.cn)(O.slug&&"border-destructive")}),(0,i.jsx)("p",{className:(0,_.cn)("text-xs",O.slug?"text-destructive":"text-muted-foreground"),children:O.slug||"App Id must be at least ".concat(4," characters. Only lowercase letters, numbers, _ and - allowed")})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.J,{htmlFor:"visibility",children:"Visibility"}),(0,i.jsxs)(ex.l6,{value:N.visibility,onValueChange:e=>{C({...N,visibility:e}),A({...O,visibility:void 0})},disabled:x,children:[(0,i.jsx)(ex.bq,{className:"w-[200px]",children:(0,i.jsx)(ex.yv,{placeholder:"Select visibility"})}),(0,i.jsxs)(ex.gC,{children:[(0,i.jsx)(ex.eb,{value:"public",children:"Public (Everyone)"}),(0,i.jsx)(ex.eb,{value:"unlisted",children:"Unlisted (People with the Link)"})]})]})]}),"unlisted"===N.visibility&&!$&&(0,i.jsx)(U.Fc,{variant:"warning",children:(0,i.jsxs)(U.TN,{className:"flex items-center justify-between",children:[(0,i.jsx)("span",{children:"Please upgrade your plan to use unlisted."}),(0,i.jsx)(w.$,{variant:"outline",size:"sm",onClick:()=>window.open("/pricing","_blank"),children:"Upgrade"})]})}),f&&(0,i.jsx)(U.Fc,{variant:"destructive",children:(0,i.jsx)(U.TN,{children:f.split("\n").map((e,t)=>(0,i.jsxs)("span",{children:[e,t<f.split("\n").length-1&&(0,i.jsx)("br",{})]},t))})}),F&&(0,i.jsx)(U.Fc,{children:(0,i.jsx)(U.TN,{className:"text-green-600",children:F})})]})}),(0,i.jsxs)(o.Es,{className:"flex-row justify-between sm:justify-between",children:[I&&N.slug&&(0,i.jsx)(w.$,{variant:"outline",asChild:!0,children:(0,i.jsxs)("a",{href:"https://".concat(N.slug,".oneapp.dev"),target:"_blank",rel:"noopener noreferrer",children:["View Your App",(0,i.jsx)(b.A,{className:"ml-2 h-4 w-4"})]})}),(0,i.jsxs)("div",{className:"flex gap-2 ml-auto",children:[(0,i.jsx)(w.$,{variant:"outline",onClick:()=>m(!1),disabled:x,children:"Close"}),(0,i.jsx)(w.$,{onClick:V,disabled:D||x||j||"unlisted"===N.visibility&&!$,children:x?(0,i.jsx)(S.A,{className:"h-4 w-4 animate-spin"}):"Deploy"})]})]})]})})]})},eb=e=>{var t,s;let{codeObj:l,embed:o,running:d,showAi:c,source:h,hideNew:p,handleNewClick:u,hideLanguageSelection:m,handleLanguageModelOpen:x,codeVsConsoleSwitchValue:g,hideRun:j,handleRunClick:b,hideEditorOptions:v,handleEditorSettingsOpen:f,handleClearOutput:y,handleCodeMetaEdit:N,fullscreen:C,switchFullscreen:k,handleCodeVsConsoleSwitch:O}=e,S=(0,K.q)(),A=(0,X.M)(),I=(0,Y.U)("(min-width: 640px)"),T=(0,Y.U)("(max-width: 639px)"),[F,U]=a.useState(!1),M="home"===h&&(null==(s=n[l.properties.language])||null==(t=s.properties)?void 0:t.enableDeployments);return S?(0,i.jsxs)(i.Fragment,{children:[M&&I&&(0,i.jsx)(ej,{codeObj:l}),M&&T&&(0,i.jsx)(ej,{codeObj:l,hideIcon:!0,open:F,onOpenChange:U}),c&&(0,i.jsx)("div",{className:"pr-2.5",children:(0,i.jsx)(eu,{codeObj:l,embedMode:!0})}),"home"===h&&(0,i.jsx)("div",{className:"pr-2.5",children:(0,i.jsx)(eu,{codeObj:l,embedMode:!1})}),!0!==m&&I&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsxs)(w.$,{size:"sm",className:"mr-2.5 bg-primary/90 hover:bg-primary-dark",onClick:e=>{x()},children:[l.properties.language.toUpperCase()," ",(0,i.jsx)(B.A,{className:"h-4 w-4 ml-1"})]})}),(0,i.jsx)(z.ZI,{children:"Click to change the language"})]})}),T&&(0,i.jsxs)("div",{className:"inline-flex mr-2.5 border border-border rounded overflow-hidden",children:[(0,i.jsx)(w.$,{variant:"ghost",size:"sm",className:(0,_.cn)("rounded-none text-muted-foreground","code"===g&&("dark"===A.theme?"bg-zinc-700":"bg-gray-300")),onClick:()=>O("code"),children:"CODE"}),(0,i.jsx)(w.$,{variant:"ghost",size:"sm",className:(0,_.cn)("rounded-none border-l border-border text-muted-foreground","console"===g&&("dark"===A.theme?"bg-zinc-700":"bg-gray-300")),onClick:()=>O("console"),children:"I/O"})]}),!0!==j&&(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsxs)(w.$,{size:"sm",variant:"secondary",className:"mr-2.5 bg-secondary/95 hover:bg-secondary-dark",onClick:e=>b(),disabled:d,children:["RUN ",(0,i.jsx)(G.A,{className:"h-4 w-4 ml-1 fill-current"})]})}),(0,i.jsx)(z.ZI,{children:window.navigator.platform.match(/^Mac/)?"⌘ + return":"ctrl + enter"})]}),!0!==v&&(0,i.jsxs)(Q.rI,{children:[(0,i.jsx)(Q.ty,{asChild:!0,children:(0,i.jsx)(w.$,{variant:"ghost",size:"icon","aria-label":"more-options",children:(0,i.jsx)(H.A,{className:"h-5 w-5"})})}),(0,i.jsxs)(Q.SQ,{align:"end",children:[!0!==p&&(0,i.jsx)(Q._2,{onClick:()=>u(l.properties.language),children:"Reset"}),(0,i.jsx)(Q._2,{onClick:()=>{l.properties.files.map(e=>r.A.downloadEditorFile(e.name,e.content))},children:"Download"}),(0,i.jsx)(Q._2,{onClick:()=>{f()},children:"Editor Settings"}),!o&&(0,i.jsx)(Q._2,{onClick:()=>{y()},children:"Clear Output"}),!o&&(0,i.jsx)(Q._2,{onClick:()=>{N()},children:"Title & Visibility"}),T&&M&&(0,i.jsx)(Q._2,{onClick:()=>{U(!0)},children:"Deploy"}),T&&k&&(0,i.jsx)(Q._2,{onClick:()=>{k(l)},children:C?"Exit Full Screen":"Full Screen"})]})]}),k&&I&&(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsx)(w.$,{variant:"ghost",size:"icon",onClick:()=>k(l),children:C?(0,i.jsx)(W.A,{className:"h-5 w-5"}):(0,i.jsx)(q.A,{className:"h-5 w-5"})})}),(0,i.jsx)(z.ZI,{children:"Full Screen"})]})]}):null};var ev=s(67909),ef=s(56745),ey=s(47055);function ew(e){let{className:t}=e;return(0,i.jsxs)("div",{className:(0,_.cn)("h-1 w-full bg-primary/20 overflow-hidden",t),children:[(0,i.jsx)("style",{children:"\n          @keyframes loading-bar {\n            0% { transform: translateX(-100%); }\n            100% { transform: translateX(100%); }\n          }\n        "}),(0,i.jsx)("div",{className:"h-full w-full bg-primary",style:{animation:"loading-bar 1.5s ease-in-out infinite"}})]})}var eN=s(98637);let eC=e=>{var t,s,a,l,r;let o=(0,ey.M)(),{language:d,running:h,codeObj:p,hideStdin:u,handleInputUpdate:m}=e,x=(0,Y.U)("(min-width: 1024px)");return(0,i.jsxs)(i.Fragment,{children:[p&&(null==(t=n[null==p||null==(s=p.properties)?void 0:s.language])?void 0:t.languageType)==="web"&&(0,i.jsx)("div",{id:"resultBrowser",className:"h-full",style:{height:e.isMobile?"calc(100vh - 105px)":"100%"},children:(0,i.jsx)(eN.A,{running:h,codeObj:p,language:d})}),p&&(null==(a=n[null==p||null==(l=p.properties)?void 0:l.language])?void 0:a.languageType)!=="web"&&(0,i.jsx)("div",{style:{height:e.isMobile?"calc(100vh - 105px)":"100%"},children:(0,i.jsxs)(ef.YZ,{direction:"vertical",children:[!0!==u&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(ef.Zk,{defaultSize:x?11:20,children:(0,i.jsx)("div",{className:"h-full overflow-auto flex flex-col",children:(0,i.jsxs)("div",{className:"flex flex-col h-full",children:[(0,i.jsx)(c.J,{className:"text-xs text-muted-foreground px-2 pt-2",children:"STDIN"}),(0,i.jsx)(M.T,{className:"flex-1 resize-none border-0 focus-visible:ring-0 rounded-none text-sm bg-transparent dark:bg-transparent",onChange:e=>m(e.target.value),value:(null==p||null==(r=p.properties)?void 0:r.stdin)||"",placeholder:"Input for the program ( Optional )"})]})})})}),(0,i.jsx)(ef.TW,{style:{height:h||p.properties.result?"1px":"5px"},className:(0,_.cn)("dark"===o.theme?"bg-muted":"bg-gray-100")}),(0,i.jsxs)(ef.Zk,{children:[h&&(0,i.jsx)(ew,{}),(0,i.jsxs)("div",{className:(0,_.cn)("pl-2 overflow-auto max-h-full",!h&&p.properties.result&&(p.properties.result.success?"border-t-[1.5px] border-green-400":"border-t border-red-400")),children:[(0,i.jsxs)("div",{className:"flex items-center justify-between my-3 pr-2",children:[(0,i.jsx)("p",{className:"text-sm",children:"Output:"}),p.properties.result&&(p.properties.result.executionTime>0||p.properties.result.memoryUsed>0)&&(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsxs)("span",{className:"text-xs text-muted-foreground cursor-default",children:[p.properties.result.executionTime>0&&"".concat(p.properties.result.executionTime," ms"),p.properties.result.executionTime>0&&p.properties.result.memoryUsed>0&&" | ",p.properties.result.memoryUsed>0&&"".concat((p.properties.result.memoryUsed/1024).toFixed(1)," MB")]})}),(0,i.jsx)(z.ZI,{children:(0,i.jsxs)("div",{className:"text-xs",children:[p.properties.result.compilationTime>0&&(0,i.jsxs)("p",{children:["Compilation Time:"," ",p.properties.result.compilationTime," ","milliseconds"]}),p.properties.result.executionTime>0&&(0,i.jsxs)("p",{children:["Execution Time:"," ",p.properties.result.executionTime," ","milliseconds"]}),p.properties.result.memoryUsed>0&&(0,i.jsxs)("p",{children:["Memory Used:"," ",p.properties.result.memoryUsed," KB"]})]})})]})]}),(0,i.jsx)("div",{children:(0,i.jsx)("pre",{className:"text-sm leading-[1.43]",children:p.properties.result&&p.properties.result.output||"Click on RUN button to see the output"})})]})]})]},x)})]})},ek=(0,ev.default)(()=>Promise.all([s.e(6213),s.e(432),s.e(3608),s.e(8164)]).then(s.bind(s,68164)),{loadableGenerated:{webpack:()=>[68164]},ssr:!1}),eO=e=>{let{language:t,running:s,hideStdin:a,codeObj:l,isOwnCode:r,hideResult:o,handleUpdate:d,codeVsConsoleSwitchValue:c,handleRunClick:h,height:p,codeTabIndex:u,disableCopyPaste:m,editorReadOnly:x,readOnlyList:g,handleInputUpdate:j}=e,b=(0,Y.U)("(max-width: 640px)"),v=(0,X.M)().theme;return(0,i.jsxs)(ef.YZ,{autoSaveId:"oc:editor",direction:"horizontal",children:[!(b&&"console"===c)&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(ef.Zk,{defaultSize:60,children:l.properties.files.length>u&&(0,i.jsx)(ek,{onRun:()=>{h()},height:p||"100%",value:l.properties.files[u].content,mode:n[l.properties.language].fileVsMode?n[l.properties.language].fileVsMode[l.properties.files[u].name.split(".").pop()]:n[l.properties.language].mode,theme:(null==v?void 0:v.startsWith("dark"))?"dark":n[l.properties.language].theme,elevation:0,disableCopyPaste:m,readOnly:x||g&&g.length>0&&g.includes(l.properties.files[u].name),onChange:e=>{let t=[...l.properties.files];t[u].content=e,d(t,r)}})})}),!0!==o&&!(b&&"code"===c)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ef.TW,{className:"dark"===v?"w-[5px] bg-muted hover:bg-zinc-700 transition-colors":"w-[5px] bg-gray-100 hover:bg-gray-300 transition-colors"}),(0,i.jsx)(ef.Zk,{defaultSize:40,children:(0,i.jsx)(eC,{isMobile:b,language:t,running:s,codeObj:l,hideStdin:a,handleInputUpdate:j})})]})]})};var eS=s(6191),eA=s(87855),eI=s(18514);let eT=function(e){let{handleEdit:t,handleDelete:s,label:a,selected:l,onClick:n,...r}=e;return(0,i.jsxs)("button",{type:"button",role:"tab","aria-selected":l,onClick:n,className:(0,_.cn)("group inline-flex items-center px-3 py-3 text-sm font-medium transition-colors","hover:text-primary dark:hover:text-foreground border-b-2",l?"text-primary dark:text-foreground border-primary dark:border-foreground":"text-muted-foreground border-transparent"),...r,children:[(0,i.jsx)("span",{children:a}),(0,i.jsxs)("span",{className:(0,_.cn)("inline-flex items-center ml-1 invisible group-hover:visible",l&&"visible md:invisible"),children:[t&&(0,i.jsx)("span",{role:"button",tabIndex:0,"aria-label":"Edit ".concat(a),className:"inline-flex items-center justify-center h-5 w-5 ml-1 rounded hover:bg-accent cursor-pointer",onClick:e=>{e.stopPropagation(),t()},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.stopPropagation(),t())},children:(0,i.jsx)(eI.A,{className:"h-3 w-3"})}),s&&(0,i.jsx)("span",{role:"button",tabIndex:0,"aria-label":"Delete ".concat(a),className:"inline-flex items-center justify-center h-5 w-5 ml-1 rounded hover:bg-accent cursor-pointer",onClick:e=>{e.stopPropagation(),s()},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.stopPropagation(),s())},children:(0,i.jsx)(g.A,{className:"h-3 w-3"})})]})]})};var eF=s(37709);let e_=e=>{var t,s;let{codeObj:l,token:h,isOwnCode:p,codeTabIndex:u,handleTabChange:m,handleUpdate:x,hideNewFileOption:g,readOnlyList:j,handleNewCodeId:b,handleAssestsOpen:v,handleAIImageOpen:f,embed:y}=e,[N,C]=a.useState(!1),[k,O]=a.useState(!1),[S,I]=a.useState(null),[T,F]=a.useState(""),[_,U]=a.useState(null),M=()=>{C(!1),I(null),F("")},E=()=>{O(!1),U(null)};return(0,i.jsxs)("div",{className:"flex flex-row items-center",children:[(0,i.jsx)("div",{role:"tablist",className:"flex overflow-x-auto [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:null==l||null==(s=l.properties)||null==(t=s.files)?void 0:t.map((e,t)=>(0,i.jsx)(eT,{label:e.name,selected:u===t,onClick:()=>m(t),handleEdit:n[l.properties.language].properties.filesEditable?()=>(e=>{I(e),F(l.properties.files[e].name),C(!0)})(t):null,handleDelete:!g&&n[l.properties.language].properties.newFileOptions&&n[l.properties.language].properties.newFileOptions.length&&!((null==j?void 0:j.length)>0&&j.includes(e.name))?()=>{U(e.name),O(!0)}:null},e.name))}),r.A.canHaveNewFiles(l)&&!g&&(0,i.jsxs)(Q.rI,{children:[(0,i.jsx)(Q.ty,{asChild:!0,children:(0,i.jsx)(w.$,{variant:"ghost",size:"icon","aria-label":"more-options-add-file",children:(0,i.jsx)(eS.A,{className:"h-5 w-5 text-muted-foreground dark:text-foreground"})})}),(0,i.jsx)(Q.SQ,{align:"start",children:n[l.properties.language].properties.newFileOptions.map(e=>(0,i.jsx)(Q._2,{onClick:()=>{let t=[...l.properties.files],s=r.A.createNewFileAndContent(l.properties.files,e);s&&(t.push({...s}),x(t,p,!1,!0))},children:e.helpText},e.helpText))})]}),r.A.canHaveImageUpload(l)&&!y&&(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsx)(w.$,{variant:"ghost",size:"icon","aria-label":"upload-image",onClick:()=>{if(!h)return void(0,eF.o)("Please login to upload images",{icon:"⚠️"});l._id||b(),v()},children:(0,i.jsx)(eA.A,{className:"h-5 w-5 text-muted-foreground dark:text-foreground"})})}),(0,i.jsx)(z.ZI,{children:"Upload Images"})]}),r.A.canHaveImageUpload(l)&&!y&&(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsx)(w.$,{variant:"ghost",size:"icon","aria-label":"ai-image-generation",className:"hidden sm:inline-flex",onClick:()=>{if(!h)return void(0,eF.o)("Please login to use AI image generation",{icon:"⚠️"});l._id||b(),f()},children:(0,i.jsx)(A.A,{className:"h-5 w-5 text-muted-foreground dark:text-foreground"})})}),(0,i.jsx)(z.ZI,{children:"AI Image Generation"})]}),(0,i.jsx)(o.lG,{open:N,onOpenChange:C,children:(0,i.jsxs)(o.Cf,{className:"sm:max-w-md",children:[(0,i.jsx)(o.c7,{children:(0,i.jsx)(o.L3,{children:"Rename File"})}),(0,i.jsx)("div",{className:"grid gap-4 py-4",children:(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(c.J,{htmlFor:"filename",children:"File Name"}),(0,i.jsx)(d.p,{id:"filename",value:T,onChange:e=>F(e.target.value),autoFocus:!0})]})}),(0,i.jsxs)(o.Es,{children:[(0,i.jsx)(w.$,{variant:"outline",onClick:M,children:"Cancel"}),(0,i.jsx)(w.$,{onClick:()=>{if(T&&null!==S){let e=[...l.properties.files];e[S].name=T,x(e,p,!0)}M()},children:"Rename"})]})]})}),(0,i.jsx)(o.lG,{open:k,onOpenChange:O,children:(0,i.jsxs)(o.Cf,{children:[(0,i.jsxs)(o.c7,{children:[(0,i.jsx)(o.L3,{children:"Delete File"}),(0,i.jsxs)(o.rr,{children:['Are you sure you want to delete the file "',_,'"? This action cannot be undone.']})]}),(0,i.jsxs)(o.Es,{children:[(0,i.jsx)(w.$,{variant:"outline",onClick:E,children:"Cancel"}),(0,i.jsx)(w.$,{variant:"destructive",onClick:()=>{if(_){let e=[...l.properties.files];x(e=e.filter(e=>e.name!==_),p)}E()},children:"Delete"})]})]})})]})},eU=e=>{let{codeObj:t,isOwnCode:s,handleClick:a}=e;return(0,i.jsx)("div",{className:"flex justify-between items-end",children:(0,i.jsxs)("h1",{itemProp:"headline",className:"text-base text-primary flex items-center ".concat(s?"":"py-[3px] leading-normal"),children:[null==t?void 0:t.title,s&&(0,i.jsx)("button",{"aria-label":"Edit",onClick:a,className:"ml-1.5 text-primary hover:text-primary/80",children:(0,i.jsx)(eI.A,{className:"h-4 w-4"})})]})})};var eM=s(42196),ez=s(71360);let eE=function(e){let{open:t,codeId:s,userId:l,handleClose:n,userToken:r}=e,[d,c]=(0,a.useState)({}),[p,u]=(0,a.useState)([]),[m,x]=(0,a.useState)(!1),[g,j]=(0,a.useState)(!1),[b,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{f()},[t]);let f=async()=>{if(!t)return;if(!r)return void x(!0);let{statusCode:e,json:s}=await (0,k.ZM)("/api/assets/".concat(l),r);200===e?(u(s),x(!0)):alert("Failed to fetch assets")},N=async e=>{if(!window.confirm("Are you sure you want to delete this image? This action cannot be undone."))return;v(e);let{statusCode:t,json:s,error:i}=await (0,k.wQ)("/api/assets/".concat(l,"/").concat(e),r);v(null),200===t?(x(!1),f()):alert("Failed to delete asset. Error: "+i)},C=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"url",i=t;"img"===s&&(i='<img src="'.concat(t,'" />')),navigator.clipboard.writeText(i),c({...d,["".concat(e,"_").concat(s)]:!0}),setTimeout(()=>{c({...d,["".concat(e,"_").concat(s)]:!1})},2e3)},O=async e=>{let t=e.target.files[0];if(!t)return;if(!t.type.startsWith("image/"))return void alert("Please select an image file");if(t.size>0xa00000)return void alert("File size must be less than 10MB");var i=new FormData;i.append("upload_file",t),j(!0);let{statusCode:a,json:n,error:o}=await (0,k.zo)("/api/assets/upload/".concat(l,"/").concat(s),r,i);j(!1),200===a?(null==n?void 0:n.status)==="success"&&(null==n?void 0:n.url)&&(x(!1),f()):alert("Failed to upload file. Error: "+o),e.target.value=null};return(0,i.jsx)(o.lG,{open:t,onOpenChange:e=>!e&&n(),children:(0,i.jsxs)(o.Cf,{className:"sm:max-w-5xl overflow-hidden border-t-4 border-t-[#667eea]",showCloseButton:!1,children:[(0,i.jsx)(o.c7,{children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-xl bg-gradient-to-br from-[#667eea] to-[#764ba2] text-white",children:(0,i.jsx)(eM.A,{className:"h-5 w-5"})}),(0,i.jsx)(o.L3,{children:"Upload & Manage Images"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("input",{accept:"image/*",className:"hidden",id:"upload-image-button",type:"file",onChange:O,disabled:!l||!s||g}),(0,i.jsx)("label",{htmlFor:"upload-image-button",children:(0,i.jsx)(w.$,{asChild:!0,disabled:!l||!s||g,children:(0,i.jsxs)("span",{className:"cursor-pointer",children:[g?(0,i.jsx)(S.A,{className:"h-4 w-4 animate-spin"}):(0,i.jsx)(em.A,{className:"h-4 w-4"}),g?"Uploading...":"Upload New"]})})})]})]})}),(0,i.jsx)(h.w,{className:"my-4"}),(0,i.jsxs)("div",{className:"min-h-[400px] max-h-[60vh] overflow-y-auto",children:[!m&&(0,i.jsx)("div",{className:"flex justify-center items-center min-h-[300px]",children:(0,i.jsx)(S.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),m&&!r&&(0,i.jsx)("div",{className:"rounded-lg border bg-blue-50 dark:bg-blue-950/30 p-4 text-blue-900 dark:text-blue-200",children:"Please login to upload and manage images"}),m&&r&&0===p.length&&(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[300px]",children:[(0,i.jsx)(eM.A,{className:"h-20 w-20 text-muted-foreground/30 mb-4"}),(0,i.jsx)("h6",{className:"text-lg font-medium text-muted-foreground mb-1",children:"No images uploaded yet"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:'Click "Upload New" to add your first image'})]}),m&&p.length>0&&(0,i.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:(0,i.jsx)(z.Bc,{children:p.map(e=>(0,i.jsxs)("div",{className:"border rounded-lg overflow-hidden bg-card transition-all hover:shadow-lg hover:-translate-y-0.5",children:[(0,i.jsx)("img",{src:e.url,alt:"Uploaded image",className:"w-full h-[200px] object-cover bg-muted"}),(0,i.jsxs)("div",{className:"p-3 space-y-2",children:[(0,i.jsx)("div",{className:"bg-muted/50 border rounded p-2 text-xs font-mono break-all max-h-[60px] overflow-auto",children:e.url}),(0,i.jsx)(y.E,{variant:"outline",className:"text-xs",children:function(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}(e.size)})]}),(0,i.jsx)(h.w,{}),(0,i.jsxs)("div",{className:"flex items-center justify-between px-3 py-2",children:[(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsx)(w.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>C(e._id,e.url,"url"),children:(0,i.jsx)(T.A,{className:"h-4 w-4 ".concat(d["".concat(e._id,"_url")]?"text-primary":"text-muted-foreground")})})}),(0,i.jsx)(z.ZI,{children:d["".concat(e._id,"_url")]?"Copied!":"Copy URL"})]}),(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsx)(w.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>C(e._id,e.url,"img"),children:(0,i.jsx)(F.A,{className:"h-4 w-4 ".concat(d["".concat(e._id,"_img")]?"text-primary":"text-muted-foreground")})})}),(0,i.jsx)(z.ZI,{children:d["".concat(e._id,"_img")]?"Copied!":"Copy Image Tag"})]})]}),(0,i.jsxs)(z.m_,{children:[(0,i.jsx)(z.k$,{asChild:!0,children:(0,i.jsx)(w.$,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",onClick:()=>N(e._id),disabled:b===e._id,children:b===e._id?(0,i.jsx)(S.A,{className:"h-4 w-4 animate-spin"}):(0,i.jsx)(ez.A,{className:"h-4 w-4"})})}),(0,i.jsx)(z.ZI,{children:"Delete"})]})]})]},e._id))})})]}),(0,i.jsx)(h.w,{className:"my-4"}),(0,i.jsxs)(o.Es,{className:"flex-row justify-between sm:justify-between",children:[(0,i.jsxs)("span",{className:"text-xs text-muted-foreground",children:[p.length," ",1===p.length?"image":"images"]}),(0,i.jsx)(w.$,{variant:"outline",onClick:n,children:"Close"})]})]})})};class eL extends a.Component{async componentDidMount(){this.setState({isServer:!1}),this.props.preFill&&!0===this.props.preFill.listenToEvents&&window.addEventListener("message",this.handleEmbedEvent);try{var e;if(this.props.preFill&&this.props.preFill.preloadCodeIds&&this.props.preFill.preloadCodeIds[this.state.codeObj.properties.language]&&!this.state.codeObj._id&&!(null==(e=this.props.preFill.codeObj)?void 0:e._id)){let e=[...this.state.codeObj.properties.files];e[0].content="Loading, Please wait...",this.setState({editorReadOnly:!0,codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,files:e}}});let t=this.props.preFill.preloadCodeIds[this.state.codeObj.properties.language],s=await (0,k.Jt)("/api/posts/".concat(t),this.props.userToken);s?(s._id=null,s.user=null,this.props.visibility&&(s.visibility=this.props.visibility),this.setState({codeObj:{...this.state.codeObj,...s},editorReadOnly:!1}),!0===this.props.preFill.listenToEvents&&s.properties&&s.properties.stdin&&window.postMessage({eventType:"populateStdinBack",stdin:s.properties.stdin||""},"*")):this.setState({editorReadOnly:!1})}}catch(e){console.log("Error while preload code ".concat(null==e?void 0:e.message))}}componentWillUnmount(){window.removeEventListener("message",this.handleEmbedEvent,!1)}handleEmbedEvent(e){if(e.data&&e.data.eventType)if("triggerRun"===e.data.eventType)this.handleOnRunClick();else if("populateCode"===e.data.eventType)if(e.data.language&&e.data.files&&e.data.files.length>0)if(n[e.data.language]){let t=JSON.parse(JSON.stringify(n[e.data.language]));t.visibility=this.props.visibility||this.state.codeObj.visibility||"public",t.properties.files=[...e.data.files],e.data.stdin&&(t.properties.stdin=e.data.stdin),e.data.result&&(t.properties.result=e.data.result),this.setState({codeObj:t})}else console.log("Invalid language "+e.data.language);else console.log("language & files are mandatory for populateCode event");else"populateStdin"===e.data.eventType&&this.setState({codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,stdin:e.data.stdin||""}}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})}isOwnCode(){return!!this.state.codeObj&&(!!this.state.codeObj.user&&!!this.props.loggedInUserObj&&!!this.props.loggedInUserObj._id&&this.state.codeObj.user._id===this.props.loggedInUserObj._id||!!this.state.codeObj.idToken)}render(){var e,t,s,a,l,n,r;let o=this.isOwnCode(),d=(0,i.jsx)(e_,{codeObj:this.state.codeObj,isOwnCode:o,codeTabIndex:this.state.codeTabIndex,handleTabChange:e=>this.setState({codeTabIndex:e}),handleUpdate:(e,t,s,i)=>this.handleUpdateCode(e,t,s,i),hideNewFileOption:this.props.preFill.hideNewFileOption,readOnlyList:this.props.preFill.readOnlyList,embed:this.props.embed,token:this.props.token,handleNewCodeId:this.createCodeId,handleAssestsOpen:()=>this.setState({imageUploadModelOpen:!0}),handleAIImageOpen:()=>this.setState({aiImageGenerationModelOpen:!0})}),c=(0,i.jsx)("div",{className:"flex items-center justify-center sm:justify-end",children:(0,i.jsx)(eb,{embed:this.props.embed,codeObj:this.state.codeObj,showAi:null==(e=this.props.preFill)?void 0:e.showAi,hideRun:null==(t=this.props.preFill)?void 0:t.hideRun,hideEditorOptions:null==(s=this.props.preFill)?void 0:s.hideEditorOptions,source:this.props.source,running:this.state.running,codeVsConsoleSwitchValue:this.state.codeVsConsoleSwitchValue||"code",hideNew:null==(a=this.props.preFill)?void 0:a.hideNew,hideLanguageSelection:null==(l=this.props.preFill)?void 0:l.hideLanguageSelection,handleNewClick:e=>this.updateLanguage(e),handleLanguageModelOpen:()=>this.setState({languageSelectionModelOpen:!0}),handleCodeVsConsoleSwitch:e=>this.setState({codeVsConsoleSwitchValue:e}),handleRunClick:this.handleOnRunClick,handleEditorSettingsOpen:()=>this.setState({editorSettingsModelOpen:!0}),handleClearOutput:()=>this.handleClearOutput(),handleCodeMetaEdit:()=>this.setState({editingModelOpen:!0}),fullscreen:this.props.fullscreen,switchFullscreen:this.props.switchFullscreen})});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"border rounded-md",children:[this.state.isServer&&(0,i.jsx)(J,{codeObj:this.state.codeObj}),!this.state.isServer&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"hidden sm:flex flex-row justify-between items-center bg-muted",children:[(0,i.jsx)("div",{className:"flex justify-between items-center",children:d}),(0,i.jsx)("div",{children:!(this.props.preFill&&!0===this.props.preFill.hideTitle)&&(0,i.jsx)(eU,{codeObj:this.state.codeObj,isOwnCode:o,handleClick:this.toggleEditingModel})}),(0,i.jsx)("div",{children:c})]}),(0,i.jsxs)("div",{className:"flex sm:hidden flex-col justify-between items-center bg-muted pt-1",children:[(0,i.jsx)("div",{className:"w-full",children:c}),"code"===this.state.codeVsConsoleSwitchValue&&(0,i.jsx)("div",{className:"w-full",children:d})]}),(0,i.jsx)(eO,{language:this.props.language,running:this.state.running,hideStdin:(null==(n=this.props.preFill)?void 0:n.hideStdin)===!0,codeObj:this.state.codeObj,isOwnCode:o,codeVsConsoleSwitchValue:this.state.codeVsConsoleSwitchValue,handleRunClick:this.handleOnRunClick,height:this.props.height,codeTabIndex:this.state.codeTabIndex,disableCopyPaste:this.props.preFill.disableCopyPaste,editorReadOnly:this.state.editorReadOnly,readOnlyList:this.props.preFill.readOnlyList,handleUpdate:(e,t,s,i)=>this.handleUpdateCode(e,t,s,i),hideResult:null==(r=this.props.preFill)?void 0:r.hideResult,handleInputUpdate:e=>{this.setState({codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,stdin:e}}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})}})]}),(0,i.jsxs)("div",{children:[!this.props.fullscreen&&!this.props.embed&&this.state.codeObj&&this.state.codeObj.updated&&(0,i.jsx)(V,{codeObj:this.state.codeObj}),(0,i.jsx)(C,{source:this.props.source,isUserLoggedIn:!!this.props.token,countryCode:this.props.countryCode,availableLanguages:this.props.preFill?this.props.preFill.availableLanguages:null,handleListItemClick:e=>{this.setState({language:e,languageSelectionModelOpen:!1},()=>this.updateLanguage(e)),this.props.handleLanguageChange&&this.props.handleLanguageChange(e)},open:this.state.languageSelectionModelOpen,onClose:()=>{this.setState({languageSelectionModelOpen:!1})}}),(0,i.jsx)(eE,{codeId:this.state.codeObj._id,userId:this.props.loggedInUserObj._id,open:this.state.imageUploadModelOpen,handleClose:()=>this.setState({imageUploadModelOpen:!1}),userToken:this.props.token}),(0,i.jsx)(L,{codeId:this.state.codeObj._id,userId:this.props.loggedInUserObj._id,open:this.state.aiImageGenerationModelOpen,handleClose:()=>this.setState({aiImageGenerationModelOpen:!1}),userToken:this.props.token})]}),(0,i.jsx)(m,{open:this.state.editorSettingsModelOpen,onClose:()=>this.setState({editorSettingsModelOpen:!1})}),(0,i.jsx)(Z,{open:this.state.editingModelOpen,handleClose:()=>this.setState({editingModelOpen:!1}),codeObj:this.state.codeObj,handleUpdate:(e,t)=>this.handleUpdateCodeMeta(e,t),handleSave:()=>{this.setState({editingModelOpen:!1}),this.handleOnRunClick(!1)},visibility:this.props.visibility,token:this.props.token})]})})}constructor(e){var t,s;super(e),this.createCodeId=()=>{this.state.creatingCodeId||this.setState({creatingCodeId:!0,codeObj:{...this.state.codeObj,_id:null,title:"forking...",user:null}},()=>{fetch("/api/getIdAndToken").then(e=>e.json()).then(e=>{let t=e.id,s=e.token,i={...this.state.codeObj,_id:t,title:t};this.props.loggedInUserObj&&this.props.loggedInUserObj._id?i.user={_id:this.props.loggedInUserObj._id}:i.idToken=s,this.setState({creatingCodeId:!1,codeObj:i,output:null},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})})})},this.handleClearOutput=async()=>{if(this.state.running)return;let e=await (0,k.RA)("/api/code/clearOutput",this.props.token,{...this.state.codeObj});(null==e?void 0:e.error)?alert(e.error):this.setState({output:null,codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,result:null}}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})},this.handleOnRunClick=async(e,t)=>{if(this.state.running)return;let s=this.isOwnCode();void 0===e&&(e=s),this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj,"runStart"),this.setState({output:"executing...",running:!0,success:null,codeVsConsoleSwitchValue:"console"});let i=r.A.clientValidation(this.state.codeObj),a=null;if("failed"===i.status)a={stdout:null,stderr:i.message};else{var l;this.props.handleRunStart&&this.props.handleRunStart(this.state.codeObj);let e=await (0,k.RA)("/api/code/exec",this.props.token||t,{...this.state.codeObj,visibility:this.props.visibility||this.state.codeObj.visibility||"public",parentURL:null==(l=this.props.preFill)?void 0:l.parentURL});a=e.error?{stdout:null,stderr:e.error}:e.json}let{success:n,output:o,executionTime:d,memoryUsed:c,compilationTime:h}=r.A.getResult(a);this.setState({success:n,output:o,running:!1,codeObj:{...this.state.codeObj,visibility:a.newVisibility||this.state.codeObj.visibility||"public",properties:{...this.state.codeObj.properties,result:{...this.state.codeObj.properties.result||{},success:n,output:o,executionTime:d,memoryUsed:c,compilationTime:h}}}},()=>{this.props.handleRunComplete&&this.props.handleRunComplete(this.state.codeObj,s)})},this.updateLanguage=async e=>{let t={...JSON.parse(JSON.stringify(n[e]))};if(this.props.preFill&&this.props.preFill.preloadCodeIds&&this.props.preFill.preloadCodeIds[e]){let s=this.props.preFill.preloadCodeIds[e],i=await fetch("/api/posts/".concat(s),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.props.userToken)}});if(200===i.status){let e=await i.json();(t=e)._id=null,t.user=null,!0===this.props.preFill.listenToEvents&&e&&e.properties&&e.properties.stdin&&window.postMessage({eventType:"populateStdinBack",stdin:e.properties.stdin||""},"*")}else console.log("Missing permissions to preload code! id:"+s)}else!0===this.props.preFill.listenToEvents&&window.postMessage({eventType:"populateStdinBack",stdin:""},"*");this.setState({codeTabIndex:0,codeObj:{...t,visibility:this.props.visibility||this.state.codeObj.visibility||"public"}},()=>{this.props.handleNewCodeClick&&this.props.handleNewCodeClick(e)})},this.toggleEditingModel=()=>{this.setState({editingModelOpen:!this.state.editingModelOpen})},this.handleUpdateCode=(e,t,s,i)=>{s||r.A.updateFileNamesAndContent(e,this.state.codeObj.properties.language);let a=e.length<=this.state.codeTabIndex?this.state.codeTabIndex-1:this.state.codeTabIndex;-1===a&&(a=0),i&&(a=e.length-1),this.setState({codeObj:{...this.state.codeObj,properties:{...this.state.codeObj.properties,files:e}},codeTabIndex:a},()=>{t||this.createCodeId(),this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj,"codeUpdate")})},this.handleUpdateCodeMeta=(e,t)=>{this.setState({codeObj:{...this.state.codeObj,[e]:t}},()=>{this.props.handleCodeUpdate&&this.props.handleCodeUpdate(this.state.codeObj)})},this.handleTagsUpdate=e=>{if(e){let t=e.split(",").map(e=>e.trim().toLowerCase());this.setState({codeObj:{...this.state.codeObj,tags:t}})}else this.setState({codeObj:{...this.state.codeObj,tags:[]}})},this.handleCodeVsConsoleSwitch=(e,t)=>{this.setState({codeVsConsoleSwitchValue:t})},this.handleEmbedEvent=this.handleEmbedEvent.bind(this);let i=this.props.preFill||{},a=i.language||"java",l=i.codeObj||{...JSON.parse(JSON.stringify(n[a])),language:a,visibility:this.props.visibility||"public"};if((null==l||null==(t=l.properties)?void 0:t.result)&&(null==(s=n[a])?void 0:s.languageType)!=="web"){let{success:e,output:t}=r.A.getResult(l.properties.result);l.properties.result={...l.properties.result,success:e,output:t}}this.state={language:a,codeObj:l,languageSelectionModelOpen:!1,imageUploadModelOpen:!1,aiImageGenerationModelOpen:!1,output:null,running:!1,editingModelOpen:!1,creatingCodeId:!1,isServer:!0,codeTabIndex:0,editorSettingsModelOpen:!1,editorReadOnly:!1,codeVsConsoleSwitchValue:"code"}}}let e$=(0,l.Ng)(e=>({loggedInUserObj:e.user,token:e.user.token,countryCode:e.user.countryCode}),{})(eL)},35541:(e,t,s)=>{s.d(t,{U:()=>a});var i=s(12115);function a(e){let[t,s]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let i=window.matchMedia(e);i.matches!==t&&s(i.matches);let a=()=>s(i.matches);return i.addEventListener("change",a),()=>i.removeEventListener("change",a)},[t,e]),t}},47507:(e,t,s)=>{s.d(t,{bq:()=>h,eb:()=>u,gC:()=>p,l6:()=>d,yv:()=>c});var i=s(95155);s(12115);var a=s(4729),l=s(24033),n=s(5917),r=s(12108),o=s(25016);function d(e){let{...t}=e;return(0,i.jsx)(a.bL,{"data-slot":"select",...t})}function c(e){let{...t}=e;return(0,i.jsx)(a.WT,{"data-slot":"select-value",...t})}function h(e){let{className:t,size:s="default",children:n,...r}=e;return(0,i.jsxs)(a.l9,{"data-slot":"select-trigger","data-size":s,className:(0,o.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...r,children:[n,(0,i.jsx)(a.In,{asChild:!0,children:(0,i.jsx)(l.A,{className:"size-4 opacity-50"})})]})}function p(e){let{className:t,children:s,position:l="item-aligned",align:n="center",...r}=e;return(0,i.jsx)(a.ZL,{children:(0,i.jsxs)(a.UC,{"data-slot":"select-content",className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,align:n,...r,children:[(0,i.jsx)(m,{}),(0,i.jsx)(a.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,i.jsx)(x,{})]})})}function u(e){let{className:t,children:s,...l}=e;return(0,i.jsxs)(a.q7,{"data-slot":"select-item",className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...l,children:[(0,i.jsx)("span",{"data-slot":"select-item-indicator",className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,i.jsx)(a.VF,{children:(0,i.jsx)(n.A,{className:"size-4"})})}),(0,i.jsx)(a.p4,{children:s})]})}function m(e){let{className:t,...s}=e;return(0,i.jsx)(a.PP,{"data-slot":"select-scroll-up-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,i.jsx)(r.A,{className:"size-4"})})}function x(e){let{className:t,...s}=e;return(0,i.jsx)(a.wn,{"data-slot":"select-scroll-down-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,i.jsx)(l.A,{className:"size-4"})})}},92364:(e,t,s)=>{s.d(t,{A:()=>n});var i=s(95155),a=s(90235),l=s(47507);let n=e=>{let t="Public (Everyone)",s="Private (Only You)",n="Unlisted (People with the Link)";return e.channelType&&"org"===e.channelType&&(t="Public (Visible outside of org)",s="Private (Visible only for org members)",n="Unlisted (People outside org with the link)"),e.channelType&&"team"===e.channelType&&(t="Public (Visible outside of team)",s="Private (Visible only for team members)",n="Unlisted (People outside team with the link)"),(0,i.jsxs)("div",{className:"space-y-2",style:{minWidth:e.minWidth||200},children:[(0,i.jsx)(a.J,{htmlFor:"visibility-selector",children:"Visibility"}),(0,i.jsxs)(l.l6,{value:e.value,onValueChange:t=>{e.onChange(t)},children:[(0,i.jsx)(l.bq,{id:"visibility-selector",children:(0,i.jsx)(l.yv,{placeholder:"Select visibility"})}),(0,i.jsxs)(l.gC,{children:[(0,i.jsx)(l.eb,{value:"public",children:t}),(0,i.jsx)(l.eb,{value:"private",children:s}),!e.channelType&&(0,i.jsx)(l.eb,{value:"unlisted",children:n})]})]})]})}}}]);